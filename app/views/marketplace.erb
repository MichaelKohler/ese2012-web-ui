<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Dashboard - Marketplace</title>
    <%= includeERB('head.erb') %>
  </head>
  <body>
    <%= includeERB('nav.erb') %>
    <div class="container">
      <section id="content">
        <div class="row">
          <%= includeERB('sidebar.erb') %>
          <div class="span10">
            <div class="alert-success alert hidden" id="loggedin">
              <strong>Logged in!</strong><br />You've been logged in successfully!
            </div>
            <h1>Marketplace</h1>

            <table class="table">
              <thead>
                <th>Name</th>
                <th>Price</th>
                <th>Owner</th>
                <th></th>
              </thead>
              <tbody>
                <% for user in @users %>
                  <% for item in user.sell_items %>
                    <tr>
                    <td><%= item.name %></td>
                    <td><%= item.price %></td>
                    <td><a href="/profile/<%= item.owner.name %>"><%= item.owner.name %></a></td>
                    <td><a href="/buyitem/"><button class="btn btn-info small">Buy Item</button></a></td>
                    </tr>
                  <% end %>
                <% end %>
              </tbody>
            </table>
          </div>
        </div>
      </section>
    </div>

    <%= includeERB('libs.erb') %>

    <script type="text/javascript">
      // hide all notifications which should not be displayed
      // TODO!! doesn't work with Sinatra at the moment..
      if ($.getUrlVar('loggedin') == 'true')
        $('#loggedin').show();
    </script>
